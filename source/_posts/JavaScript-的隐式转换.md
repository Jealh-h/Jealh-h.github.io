---
title: JavaScript çš„éšå¼è½¬æ¢
date: 2023-03-09 21:28:10
tags: éšå¼è½¬æ¢
categories: javascript
---

å¯¹äº JavaScript ä¸­çš„ä¸€äº›è¿ç®—ç¬¦ï¼ˆå¦‚ï¼š==ï¼‰æ¥è¯´æ˜¯æ¯”è¾ƒè¿·æƒ‘çš„ã€‚å®ƒä»¬äº§ç”Ÿçš„ç»“æœæœ‰æ—¶ä¼šè®©æˆ‘ä»¬å˜å¾—æ··æ·†ï¼Œé‚£è¿™ä¸€åˆ‡çš„èƒŒåå°±æ˜¯â€œéšå¼è½¬æ¢â€åœ¨ä½œç¥Ÿäº†ã€‚

## å‰ç½®

### Number å¼ºåˆ¶è½¬æ¢

|   target   |                       number                       |
| :--------: | :------------------------------------------------: |
| undefined  |                        NaN                         |
|    null    |                         0                          |
| true/false |                        1/0                         |
|   string   |                  è§£æå¤±è´¥è¿”å› NaN                  |
|   BigInt   |                     TypeError                      |
|   Symbol   |                     TypeError                      |
|   Object   | [@@toPrimitive]("number") â†’ valueOf() â†’ toString() |

**string è§£æå¤±è´¥ï¼š**

- å¿½ç•¥å‰å¯¼ä¸å°¾éšçš„ç©ºæ ¼/è¡Œç»ˆæ­¢ç¬¦
- å‰å¯¼ 0 ä¸ä¼šè¯†åˆ«ä¸ºå…«è¿›åˆ¶æ–‡æœ¬
- +å’Œ-å…è®¸åœ¨å­—ç¬¦ä¸²å¼€å¤´ï¼Œä¸”åªèƒ½å‡ºç°ä¸€æ¬¡ï¼Œåé¢ä¸èƒ½è·Ÿç©ºæ ¼
- Infinity å’Œ -Infinity å½“ä½œå­—é¢é‡
- ç©ºä¸²æˆ–å…¨ä¸ºç©ºæ ¼è§£ææˆ 0
- ä¸èƒ½å«æ•°å­—åˆ†å‰²ç¬¦

<!-- more -->

### å¼ºåˆ¶ boolean è½¬æ¢

|              target               | Boolean |
| :-------------------------------: | :-----: |
|              0 / -0               |  false  |
|               null                |  false  |
|                NaN                |  false  |
|             undefined             |  false  |
|                ""                 |  false  |
| Object / "anything but not empty" |  true   |

### å¤æ‚ç±»å‹è½¬æ¢æˆåŸå§‹ç±»å‹

å¤æ‚æ•°æ®ç±»å‹è½¬æ¢ä¸ºåŸå§‹ç±»å‹æœ‰ä»¥ä¸‹è§„åˆ™ï¼š

- å¼ºåˆ¶åŸå§‹å€¼è½¬æ¢ï¼š[@@toPrimitive]("default") â†’ valueOf() â†’ toString()
- å¼ºåˆ¶æ•°å­—ç±»å‹è½¬æ¢ã€å¼ºåˆ¶ number ç±»å‹è½¬æ¢ã€å¼ºåˆ¶ BigInt ç±»å‹è½¬æ¢ï¼š[@@toPrimitive]("number") â†’ valueOf() â†’ toString()
- å¼ºåˆ¶å­—ç¬¦ä¸²ç±»å‹è½¬æ¢ï¼š[@@toPrimitive]("string") â†’ toString() â†’ valueOf()
- Date å’Œ Symbol å¯¹è±¡æ˜¯å”¯ä¸€é‡å†™ [@@toPrimitive] æ–¹æ³•çš„å¯¹è±¡ã€‚Date.prototype[@@toPrimitive] å°† "default" hint è§†ä¸º "string"ï¼Œè€Œ Symbol.prototype[@@toPrimitive] å¿½ç•¥ hint å¹¶å§‹ç»ˆè¿”å›ä¸€ä¸ª symbolã€‚

å…¶ä¸­ [@@toPrimitive] ä¸ºä¸€ä¸ªå†…ç½®çš„ Symbol å±æ€§ï¼Œå…¶éƒ¨ç½²æ–¹å¼ä¸ºï¼š

```typescript
const obj = {
  [Symbol.toPrimitive](hint) {
    if (hint === "number") {
      return 10;
    }
    if (hint === "string") {
      return "hello";
    }
    // 'default'
    return true;
  },
};

// é‚£ä¹ˆå½“é‡åˆ°åŸå§‹ç±»å‹è½¬æ¢æ—¶å°±ç›¸å½“äºè‡ªå®šä¹‰è½¬åŒ–äº†
const num = +obj;
// hintä¸º number, ç»“æœï¼š 10
```

## æ“ä½œç¬¦

### ==

é¦–å½“å…¶å†²çš„è‚¯å®šæ˜¯ â€==â€œï¼Œ æƒ³å¿…å…¶å·²ç»è‡­åæ˜­è‘—äº†ã€‚é‚£ä¹ˆæˆ‘ä»¬å…ˆæ¥çœ‹çœ‹å®ƒçš„ä¸€äº›å‘å‘å§ ğŸ˜€ã€‚

```typescript
{} == []
null == undefined
new String("str") == true
```

é¦–å…ˆï¼Œæˆ‘ä»¬æ˜ç¡®ä¸€ä¸‹ == çš„è§„åˆ™ï¼Œé‚£ä¹ˆå°±éå¸¸å®¹æ˜“å»åˆ¤æ–­ç»“æœäº†ï¼Œå…¶è§„åˆ™ä¸ºï¼š

1. <span id="same primitve">ç›¸åŒç±»å‹</span>ï¼š

- Object ç±»å‹ï¼šæ¯”è¾ƒå¼•ç”¨åœ°å€
- Number: æœ‰ NaN åˆ™è¿”å› false, +0 ä¸ -0 ç›¸ç­‰ï¼Œæ“ä½œæ•°ç›¸ç­‰åˆ™è¿”å› trueã€‚
- Stringï¼šåªæœ‰å½“ä¸¤ä¸ªæ“ä½œæ•°å…·æœ‰ç›¸åŒçš„å­—ç¬¦ä¸”é¡ºåºç›¸åŒæ—¶æ‰è¿”å› trueã€‚
- Booleanï¼šä»…å½“æ“ä½œæ•°éƒ½ä¸º true æˆ–éƒ½ä¸º false æ—¶è¿”å› trueã€‚
- BigIntï¼šä»…å½“ä¸¤ä¸ªæ“ä½œæ•°å€¼ç›¸åŒæ—¶è¿”å› trueã€‚
- Symbolï¼šä»…å½“ä¸¤ä¸ªæ“ä½œæ•°å¼•ç”¨ç›¸åŒçš„ç¬¦å·æ—¶è¿”å› trueã€‚
- null: å¦ä¸€ä¸ªæ•°ä¸º undefined æˆ– null æ‰è¿”å› trueã€‚å¦åˆ™è¿”å› falseã€‚
- undefined: å¦ä¸€ä¸ªæ•°ä¸º undefined æˆ– null æ‰è¿”å› trueã€‚å¦åˆ™è¿”å› falseã€‚

2. å…¶ä¸­ä¸€ä¸ªæ˜¯å¯¹è±¡ï¼Œå¦ä¸€ä¸ªæ˜¯åŸºæœ¬ç±»å‹ã€‚ä¼šæŒ‰ç…§**<a href="#å‰ç½®">å‰ç½®</a>**çš„è§„åˆ™è¿›è¡Œè½¬æ¢æˆåŸºæœ¬ç±»å‹ã€‚

3. è¿™æ—¶éƒ½æ˜¯**åŸºæœ¬ç±»å‹**äº†ï¼Œé‚£ä¹ˆæœ‰å¦‚ä¸‹è§„åˆ™ã€‚

- éƒ½æ˜¯åŸºæœ¬ç±»å‹ï¼ŒæŒ‰ç…§<a href="#same primitve">è§„åˆ™ 1</a>è¿›è¡Œå¯¹æ¯”ã€‚
- å…¶ä¸­ä¸€ä¸ªæ˜¯ Symbol, å¦ä¸€ä¸ªä¸æ˜¯ï¼Œè¿”å› falseã€‚
- å…¶ä¸­ä¸€ä¸ªæ˜¯ boolean, å¦ä¸€ä¸ªä¸æ˜¯ï¼Œåˆ™å°† boolean è½¬æ¢æˆæ•°å­—ã€‚
- Number ä¸ String å¯¹æ¯”ï¼šä½¿ç”¨ä¸ <a href="#Number å¼ºåˆ¶è½¬æ¢">Number() æ„é€ å‡½æ•°ç›¸åŒçš„ç®—æ³•</a>å°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºæ•°å­—ã€‚è½¬æ¢å¤±è´¥å°†å¯¼è‡´ NaNï¼Œè¿™å°†ä¿è¯ç›¸ç­‰æ˜¯ falseã€‚
- Number ä¸ BigInt å¯¹æ¯”ï¼šæŒ‰æ•°å€¼è¿›è¡Œæ¯”è¾ƒã€‚å¦‚æœæ•°å€¼ä¸º Â±âˆ æˆ– NaNï¼Œè¿”å› falseã€‚
- String ä¸ BigInt å¯¹æ¯”ï¼šä½¿ç”¨ä¸ BigInt() æ„é€ å‡½æ•°ç›¸åŒçš„ç®—æ³•å°†å­—ç¬¦ä¸²è½¬æ¢ä¸º BigIntã€‚å¦‚æœè½¬æ¢å¤±è´¥ï¼Œè¿”å› falseã€‚

#### å›åˆ°ä¸Šé¢˜

```typescript
{} == []
// ç›¸åŒç±»å‹éƒ½æ˜¯ Object, æ¯”è¾ƒå¼•ç”¨åœ°å€ï¼Œå› æ­¤è¿”å› false

null == undefined
// null ä¸ undefined è¿”å› true

new String("str") == true
// ä¸åŒç±»å‹
// å…ˆå°† new String("str") è½¬æ¢æˆåŸºæœ¬ç±»å‹ï¼ˆå¼ºåˆ¶å­—ç¬¦ä¸²ç±»å‹è½¬æ¢ï¼‰å¾—åˆ°ï¼š
// "str" == true
//å…¶ä¸­ä¸€ä¸ªæ˜¯ boolean ç±»å‹ï¼Œè½¬æˆ number
// "str" == 1
// å°† string è£…æ¢æˆ number
// NaN == 1
// æœ€åï¼šfalse
```

### +

**åœ¨æ±‚å€¼æ—¶ï¼Œå®ƒé¦–å…ˆå°†ä¸¤ä¸ªæ“ä½œæ•°å¼ºåˆ¶è½¬æ¢ä¸ºåŸºæœ¬ç±»å‹ã€‚ç„¶åï¼Œæ£€æŸ¥ä¸¤ä¸ªæ“ä½œæ•°çš„ç±»å‹**:

- å¤šä¸ªå€¼è¿ç®—ï¼Œè¿›è¡Œç›¸åŠ æ“ä½œï¼Œå¦‚æœå…¶ä¸­æœ‰ä¸€ä¸ªæ˜¯å­—ç¬¦ä¸²ï¼Œé‚£ä¹ˆä¼šå°†å¦ä¸€ä¸ªæ•°è½¬æ¢æˆå­—ç¬¦ä¸²ï¼Œè¿›è¡Œå­—ç¬¦ä¸²è¿æ¥ã€‚
- å¤šä¸ªå€¼è¿ç®—ï¼Œéƒ½æ˜¯ BigInt, æ‰§è¡Œ BigInt åŠ æ³•ï¼Œä¸€æ–¹æ˜¯ BigInt,å¦ä¸€ä¸ªä¸æ˜¯ï¼ŒæŠ›å‡º TypeErrorã€‚
- å¤šä¸ªå€¼è¿ç®—ï¼Œæ²¡æœ‰ Stringã€BigInt, éƒ½è½¬ä¸ºæ•°å­—ã€‚
- å•å€¼è¿ç®—ï¼Œè½¬æ¢æˆæ•°å­—

#### ä¸‹é¢æ¥çœ‹ä¸€ä¸‹å¸¸è§çš„è¿ç®— ğŸ˜

```typescript
{} + [] + {} + []
// è¿™é‡Œæœ‰ä¸€ä¸ªå‘å°±æ˜¯ {} ä¼šè¯†åˆ«ä¸ºä¸€ä¸ª block, ç„¶åå°±æˆäº†ä¸‹é¢è¿™ç§æƒ…å†µ
// + [] + {} + []
// å‰éƒ¨åˆ†å°±ç›¸å½“äºå•ç›®è¿ç®—ï¼Œè½¬æ¢æˆæ•°å­—ç±»å‹ []--valueOf-->[]--toString-->''--toNumber-->0
// 0 + {} + []
// å…ˆè½¬æ¢æˆåŸºæœ¬ç±»å‹
// 0 + '[object Object]' + []
// '0[object Object]' + []
// è½¬æ¢æˆåŸºæœ¬ç±»å‹
// '0[object Object]' + ''
// æ‹¼æ¥
//'0[object Object]'

true + 1
// å·²ç»éƒ½æ˜¯åŸºæœ¬ç±»å‹äº†
// æ²¡æœ‰ Stringã€BigIntï¼Œéƒ½è½¬æ¢æˆæ•°å­—
// 1 + 1
// 2

NaN + 1
// å·²ç»éƒ½æ˜¯åŸºæœ¬ç±»å‹äº†
// æ²¡æœ‰ Stringã€BigIntï¼Œéƒ½è½¬æ¢æˆæ•°å­—
// NaN + 1
// NaN

[] + {}
// è£…æ¢æˆåŸºæœ¬ç±»å‹
// '' + '[object Object]'
// [object Object]

{} + []
// åŒæ ·çš„å‘å°±æ˜¯ {} ä¼šè¯†åˆ«ä¸ºä¸€ä¸ª block, ç„¶åå°±æˆäº†ä¸‹é¢è¿™ç§æƒ…å†µ
// + []
// è¿™é‡Œæˆäº†å•ç›®è¿ç®—ï¼Œå°†åé¢çš„è½¬æ¢ä¸ºæ•°å€¼
// 0

ï¼ˆ{}ï¼‰ + []
// è¿™ç§æƒ…å†µå°±ä¸ [] + {} ç±»ä¼¼äº†
// '[object Object]'

// {} + {}
// å‰é¢è¯†åˆ«ä¸º block
// + {}
// å•ç›®è¿ç®—ã€‚è½¬æ¢æˆæ•°å­—
// {} --valueOf-->{}--toString-->'[object Object]'--toNumber-->NaN
// NaN

// [] + []
// è½¬æ¢æˆåŸºæœ¬ç±»å‹
// '' + ''
// æ‹¼æ¥
// ''


```

### -

- ä¸¤ä¸ªæ“ä½œæ•°ï¼šå°†ä¸¤ä¸ªæ“ä½œæ•°è½¬æ¢ä¸ºæ•°å€¼ï¼Œå¹¶æ ¹æ®ä¸¤ä¸ªæ“ä½œæ•°çš„ç±»å‹æ‰§è¡Œæ•°å­—å‡æ³•æˆ– BigInt å‡æ³•ã€‚å¦‚æœç±»å‹ä¸åŒ¹é…ï¼Œåˆ™æŠ›å‡º TypeErrorã€‚
- ä¸€ä¸ªæ“ä½œæ•°ï¼šæ•°å­—åˆ™å–åï¼Œå¦åˆ™è½¬æ¢æˆæ•°å­—ç±»å‹ã€‚

#### çœ‹çœ‹ä¾‹é¢˜

```typescript
[] - {};
// è½¬æˆæ•°å­—
// [] --valueOf--ã€‹ [] --toString--ã€‹ "" --toNumber--ã€‹ 0
// {}--valueOf--ã€‹ {}--toString--ã€‹ '[object Object]'--toNumber--ã€‹ NaN
// 0 - NaN
// NaN
```

### !

- è¿ç®—ç¬¦å°†çœŸå€¼æˆ–å‡å€¼è½¬æ¢ä¸ºå¯¹åº”çš„ç›¸åå€¼
- å½“ä¸éå¸ƒå°”å€¼ä½¿ç”¨æ—¶ï¼Œå¦‚æœå…¶æ“ä½œæ•°å¯ä»¥è½¬åŒ–ä¸º trueï¼Œåˆ™è¿”å› falseï¼Œå¦åˆ™è¿”å› trueã€‚

#### !!

åŒéè¿ç®—ç¬¦ï¼Œå°†è¿ç®—å€¼è½¬æ¢æˆç›¸åº”çš„ boolean ç±»å‹ã€‚

#### çœ‹çœ‹ä¾‹é¢˜

```typescript
![];
// å°† [] è½¬æˆ boolean, æ ¹æ®å¼ºåˆ¶Booleanè½¬æ¢(Objectç±»å‹ï¼‰ï¼š[] --> true
// !true
// false
```

### > / <

**æ‰€æœ‰çš„æ¯”è¾ƒæ“ä½œç¬¦éƒ½æ˜¯å…ˆå¼ºåˆ¶è½¬åŒ–å·¦æ“ä½œæ•°å†å¼ºåˆ¶è½¬åŒ–å³æ“ä½œæ•°ã€‚**
é¦–å…ˆï¼Œé€šè¿‡ä¾æ¬¡è°ƒç”¨å…¶ [@@toPrimitive]ï¼ˆä»¥ "number" ä½œä¸ºæç¤ºï¼‰ã€valueOf() å’Œ toString() æ–¹æ³•ï¼Œå°†å¯¹è±¡è½¬æ¢ä¸ºåŸå§‹ç±»å‹ã€‚å·¦è¾¹çš„æ“ä½œæ•°æ€»æ˜¯åœ¨å³è¾¹çš„æ“ä½œæ•°ä¹‹å‰è¢«å¼ºåˆ¶è½¬æ¢ã€‚

- å¦‚æœä¸¤ä¸ªå€¼éƒ½æ˜¯å­—ç¬¦ä¸²ï¼Œåˆ™æ ¹æ®å®ƒä»¬æ‰€åŒ…å«çš„ Unicode ç ä½çš„å€¼ï¼Œå°†å®ƒä»¬ä½œä¸ºå­—ç¬¦ä¸²è¿›è¡Œæ¯”è¾ƒã€‚
- å¦åˆ™ï¼Œå°è¯•å°†éæ•°å€¼ç±»å‹è½¬åŒ–ä¸ºæ•°å€¼ç±»å‹ã€‚
- å¦‚æœä¸€ä¸ªä¸º NaN, è¿”å› falseã€‚

#### çœ‹çœ‹ä¾‹é¢˜

```typescript
"a" < 3;
// å…ˆå°†å·¦è¾¹è½¬åŒ–ä¸ºæ•°å€¼ç±»å‹
// NaN < 3
// æœ‰ä¸€ä¸ªä¸ºNaN, è¿”å› false
// false

0 < [];
// å·¦è¾¹ä¸ºæ•°å­—ç±»å‹ï¼Œå°†å³è¾¹è½¬æ¢ä¸ºæ•°å­—ç±»å‹
// [] --toString--> '' --toNumber--> 0
// 0 < 0
// false
```

## æ€»ç»“

éšå¼è½¬æ¢çš„è§„åˆ™éå¸¸å¤šï¼Œä½†éƒ½æ˜¯å‘åŸºæœ¬ç±»å‹è½¬æ¢ï¼Œæ‰€ä»¥ç†è§£<a href="#å¤æ‚ç±»å‹è½¬æ¢æˆåŸå§‹ç±»å‹">å¤æ‚ç±»å‹è½¬æ¢æˆåŸå§‹ç±»å‹</a>æ¯”è¾ƒé‡è¦ï¼Œç‰¹åˆ«çš„è¿˜éœ€è¦æ³¨æ„ {} è¯†åˆ«ä¸ºä¸€ä¸ª block çš„æƒ…å†µã€‚

## Reference

- <https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Operators/Equality>
- <https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Data_structures#%E5%BC%BA%E5%88%B6%E5%8E%9F%E5%A7%8B%E5%80%BC%E8%BD%AC%E6%8D%A2>
- <https://www.zhihu.com/question/45478070>
